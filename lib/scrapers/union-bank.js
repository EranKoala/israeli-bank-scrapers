"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _moment = _interopRequireDefault(require("moment"));
var _constants = require("../constants");
var _elementsInteractions = require("../helpers/elements-interactions");
var _navigation = require("../helpers/navigation");
var _transactions = require("../transactions");
var _baseScraperWithBrowser = require("./base-scraper-with-browser");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const BASE_URL = 'https://hb.unionbank.co.il';
const TRANSACTIONS_URL = `${BASE_URL}/eBanking/Accounts/ExtendedActivity.aspx#/`;
const DATE_FORMAT = 'DD/MM/YY';
const NO_TRANSACTION_IN_DATE_RANGE_TEXT = 'לא קיימות תנועות מתאימות על פי הסינון שהוגדר';
const DATE_HEADER = 'תאריך';
const DESCRIPTION_HEADER = 'תיאור';
const REFERENCE_HEADER = 'אסמכתא';
const DEBIT_HEADER = 'חובה';
const CREDIT_HEADER = 'זכות';
const PENDING_TRANSACTIONS_TABLE_ID = 'trTodayActivityNapaTableUpper';
const COMPLETED_TRANSACTIONS_TABLE_ID = 'ctlActivityTable';
const ERROR_MESSAGE_CLASS = 'errInfo';
const ACCOUNTS_DROPDOWN_SELECTOR = 'select#ddlAccounts_m_ddl';
function getPossibleLoginResults() {
  const urls = {};
  urls[_baseScraperWithBrowser.LoginResults.Success] = [/eBanking\/Accounts/];
  urls[_baseScraperWithBrowser.LoginResults.InvalidPassword] = [/InternalSite\/CustomUpdate\/leumi\/LoginPage.ASP/];
  return urls;
}
function createLoginFields(credentials) {
  return [{
    selector: '#uid',
    value: credentials.username
  }, {
    selector: '#password',
    value: credentials.password
  }];
}
function getAmountData(amountStr) {
  const amountStrCopy = amountStr.replace(',', '');
  return parseFloat(amountStrCopy);
}
function getTxnAmount(txn) {
  const credit = getAmountData(txn.credit);
  const debit = getAmountData(txn.debit);
  return (Number.isNaN(credit) ? 0 : credit) - (Number.isNaN(debit) ? 0 : debit);
}
function convertTransactions(txns) {
  return txns.map(txn => {
    const convertedDate = (0, _moment.default)(txn.date, DATE_FORMAT).toISOString();
    const convertedAmount = getTxnAmount(txn);
    return {
      type: _transactions.TransactionTypes.Normal,
      identifier: txn.reference ? parseInt(txn.reference, 10) : undefined,
      date: convertedDate,
      processedDate: convertedDate,
      originalAmount: convertedAmount,
      originalCurrency: _constants.SHEKEL_CURRENCY,
      chargedAmount: convertedAmount,
      status: txn.status,
      description: txn.description,
      memo: txn.memo
    };
  });
}
function getTransactionDate(tds, txnsTableHeaders) {
  return (tds[txnsTableHeaders[DATE_HEADER]] || '').trim();
}
function getTransactionDescription(tds, txnsTableHeaders) {
  return (tds[txnsTableHeaders[DESCRIPTION_HEADER]] || '').trim();
}
function getTransactionReference(tds, txnsTableHeaders) {
  return (tds[txnsTableHeaders[REFERENCE_HEADER]] || '').trim();
}
function getTransactionDebit(tds, txnsTableHeaders) {
  return (tds[txnsTableHeaders[DEBIT_HEADER]] || '').trim();
}
function getTransactionCredit(tds, txnsTableHeaders) {
  return (tds[txnsTableHeaders[CREDIT_HEADER]] || '').trim();
}
function extractTransactionDetails(txnRow, txnsTableHeaders, txnStatus) {
  const tds = txnRow.innerTds;
  return {
    status: txnStatus,
    date: getTransactionDate(tds, txnsTableHeaders),
    description: getTransactionDescription(tds, txnsTableHeaders),
    reference: getTransactionReference(tds, txnsTableHeaders),
    debit: getTransactionDebit(tds, txnsTableHeaders),
    credit: getTransactionCredit(tds, txnsTableHeaders),
    memo: ''
  };
}
function isExpandedDescRow(txnRow) {
  return txnRow.id === 'rowAdded';
}

/* eslint-disable no-param-reassign */
function editLastTransactionDesc(txnRow, lastTxn) {
  lastTxn.description = `${lastTxn.description} ${txnRow.innerTds[0]}`;
  return lastTxn;
}
function handleTransactionRow(txns, txnsTableHeaders, txnRow, txnType) {
  if (isExpandedDescRow(txnRow)) {
    const lastTransaction = txns.pop();
    if (lastTransaction) {
      txns.push(editLastTransactionDesc(txnRow, lastTransaction));
    } else {
      throw new Error('internal union-bank error');
    }
  } else {
    txns.push(extractTransactionDetails(txnRow, txnsTableHeaders, txnType));
  }
}
async function getTransactionsTableHeaders(page, tableTypeId) {
  const headersMap = [];
  const headersObjs = await (0, _elementsInteractions.pageEvalAll)(page, `#WorkSpaceBox #${tableTypeId} tr[class='header'] th`, null, ths => {
    return ths.map((th, index) => ({
      text: th.innerText.trim(),
      index
    }));
  });
  for (const headerObj of headersObjs) {
    headersMap[headerObj.text] = headerObj.index;
  }
  return headersMap;
}
async function extractTransactionsFromTable(page, tableTypeId, txnType) {
  const txns = [];
  const transactionsTableHeaders = await getTransactionsTableHeaders(page, tableTypeId);
  const transactionsRows = await (0, _elementsInteractions.pageEvalAll)(page, `#WorkSpaceBox #${tableTypeId} tr[class]:not([class='header'])`, [], trs => {
    return trs.map(tr => ({
      id: tr.getAttribute('id') || '',
      innerTds: Array.from(tr.getElementsByTagName('td')).map(td => td.innerText)
    }));
  });
  for (const txnRow of transactionsRows) {
    handleTransactionRow(txns, transactionsTableHeaders, txnRow, txnType);
  }
  return txns;
}
async function isNoTransactionInDateRangeError(page) {
  const hasErrorInfoElement = await (0, _elementsInteractions.elementPresentOnPage)(page, `.${ERROR_MESSAGE_CLASS}`);
  if (hasErrorInfoElement) {
    const errorText = await page.$eval(`.${ERROR_MESSAGE_CLASS}`, errorElement => {
      return errorElement.innerText;
    });
    return errorText.trim() === NO_TRANSACTION_IN_DATE_RANGE_TEXT;
  }
  return false;
}
async function chooseAccount(page, accountId) {
  const hasDropDownList = await (0, _elementsInteractions.elementPresentOnPage)(page, ACCOUNTS_DROPDOWN_SELECTOR);
  if (hasDropDownList) {
    await (0, _elementsInteractions.dropdownSelect)(page, ACCOUNTS_DROPDOWN_SELECTOR, accountId);
  }
}
async function searchByDates(page, startDate) {
  await (0, _elementsInteractions.dropdownSelect)(page, 'select#ddlTransactionPeriod', '004');
  await (0, _elementsInteractions.waitUntilElementFound)(page, 'select#ddlTransactionPeriod');
  await (0, _elementsInteractions.fillInput)(page, 'input#dtFromDate_textBox', startDate.format(DATE_FORMAT));
  await (0, _elementsInteractions.clickButton)(page, 'input#btnDisplayDates');
  await (0, _navigation.waitForNavigation)(page);
}
async function getAccountNumber(page) {
  const selectedSnifAccount = await page.$eval('#ddlAccounts_m_ddl option[selected="selected"]', option => {
    return option.innerText;
  });
  return selectedSnifAccount.replace('/', '_');
}
async function expandTransactionsTable(page) {
  const hasExpandAllButton = await (0, _elementsInteractions.elementPresentOnPage)(page, "a[id*='lnkCtlExpandAll']");
  if (hasExpandAllButton) {
    await (0, _elementsInteractions.clickButton)(page, "a[id*='lnkCtlExpandAll']");
  }
}
async function scrapeTransactionsFromTable(page) {
  const pendingTxns = await extractTransactionsFromTable(page, PENDING_TRANSACTIONS_TABLE_ID, _transactions.TransactionStatuses.Pending);
  const completedTxns = await extractTransactionsFromTable(page, COMPLETED_TRANSACTIONS_TABLE_ID, _transactions.TransactionStatuses.Completed);
  const txns = [...pendingTxns, ...completedTxns];
  return convertTransactions(txns);
}
async function getAccountTransactions(page) {
  await Promise.race([(0, _elementsInteractions.waitUntilElementFound)(page, `#${COMPLETED_TRANSACTIONS_TABLE_ID}`, false), (0, _elementsInteractions.waitUntilElementFound)(page, `.${ERROR_MESSAGE_CLASS}`, false)]);
  const noTransactionInRangeError = await isNoTransactionInDateRangeError(page);
  if (noTransactionInRangeError) {
    return [];
  }
  await expandTransactionsTable(page);
  return scrapeTransactionsFromTable(page);
}
async function fetchAccountData(page, startDate, accountId) {
  await chooseAccount(page, accountId);
  await searchByDates(page, startDate);
  const accountNumber = await getAccountNumber(page);
  const txns = await getAccountTransactions(page);
  return {
    accountNumber,
    txns
  };
}
async function fetchAccounts(page, startDate) {
  const accounts = [];
  const accountsList = await (0, _elementsInteractions.dropdownElements)(page, ACCOUNTS_DROPDOWN_SELECTOR);
  for (const account of accountsList) {
    if (account.value !== '-1') {
      // Skip "All accounts" option
      const accountData = await fetchAccountData(page, startDate, account.value);
      accounts.push(accountData);
    }
  }
  return accounts;
}
async function waitForPostLogin(page) {
  return Promise.race([(0, _elementsInteractions.waitUntilElementFound)(page, '#signoff', true), (0, _elementsInteractions.waitUntilElementFound)(page, '#restore', true)]);
}
class UnionBankScraper extends _baseScraperWithBrowser.BaseScraperWithBrowser {
  getLoginOptions(credentials) {
    return {
      loginUrl: `${BASE_URL}`,
      fields: createLoginFields(credentials),
      submitButtonSelector: '#enter',
      postAction: async () => waitForPostLogin(this.page),
      possibleResults: getPossibleLoginResults()
    };
  }
  async fetchData() {
    const defaultStartMoment = (0, _moment.default)().subtract(1, 'years').add(1, 'day');
    const startDate = this.options.startDate || defaultStartMoment.toDate();
    const startMoment = _moment.default.max(defaultStartMoment, (0, _moment.default)(startDate));
    await this.navigateTo(TRANSACTIONS_URL);
    const accounts = await fetchAccounts(this.page, startMoment);
    return {
      success: true,
      accounts
    };
  }
}
var _default = exports.default = UnionBankScraper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfY29uc3RhbnRzIiwiX2VsZW1lbnRzSW50ZXJhY3Rpb25zIiwiX25hdmlnYXRpb24iLCJfdHJhbnNhY3Rpb25zIiwiX2Jhc2VTY3JhcGVyV2l0aEJyb3dzZXIiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJCQVNFX1VSTCIsIlRSQU5TQUNUSU9OU19VUkwiLCJEQVRFX0ZPUk1BVCIsIk5PX1RSQU5TQUNUSU9OX0lOX0RBVEVfUkFOR0VfVEVYVCIsIkRBVEVfSEVBREVSIiwiREVTQ1JJUFRJT05fSEVBREVSIiwiUkVGRVJFTkNFX0hFQURFUiIsIkRFQklUX0hFQURFUiIsIkNSRURJVF9IRUFERVIiLCJQRU5ESU5HX1RSQU5TQUNUSU9OU19UQUJMRV9JRCIsIkNPTVBMRVRFRF9UUkFOU0FDVElPTlNfVEFCTEVfSUQiLCJFUlJPUl9NRVNTQUdFX0NMQVNTIiwiQUNDT1VOVFNfRFJPUERPV05fU0VMRUNUT1IiLCJnZXRQb3NzaWJsZUxvZ2luUmVzdWx0cyIsInVybHMiLCJMb2dpblJlc3VsdHMiLCJTdWNjZXNzIiwiSW52YWxpZFBhc3N3b3JkIiwiY3JlYXRlTG9naW5GaWVsZHMiLCJjcmVkZW50aWFscyIsInNlbGVjdG9yIiwidmFsdWUiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZ2V0QW1vdW50RGF0YSIsImFtb3VudFN0ciIsImFtb3VudFN0ckNvcHkiLCJyZXBsYWNlIiwicGFyc2VGbG9hdCIsImdldFR4bkFtb3VudCIsInR4biIsImNyZWRpdCIsImRlYml0IiwiTnVtYmVyIiwiaXNOYU4iLCJjb252ZXJ0VHJhbnNhY3Rpb25zIiwidHhucyIsIm1hcCIsImNvbnZlcnRlZERhdGUiLCJtb21lbnQiLCJkYXRlIiwidG9JU09TdHJpbmciLCJjb252ZXJ0ZWRBbW91bnQiLCJ0eXBlIiwiVHJhbnNhY3Rpb25UeXBlcyIsIk5vcm1hbCIsImlkZW50aWZpZXIiLCJyZWZlcmVuY2UiLCJwYXJzZUludCIsInVuZGVmaW5lZCIsInByb2Nlc3NlZERhdGUiLCJvcmlnaW5hbEFtb3VudCIsIm9yaWdpbmFsQ3VycmVuY3kiLCJTSEVLRUxfQ1VSUkVOQ1kiLCJjaGFyZ2VkQW1vdW50Iiwic3RhdHVzIiwiZGVzY3JpcHRpb24iLCJtZW1vIiwiZ2V0VHJhbnNhY3Rpb25EYXRlIiwidGRzIiwidHhuc1RhYmxlSGVhZGVycyIsInRyaW0iLCJnZXRUcmFuc2FjdGlvbkRlc2NyaXB0aW9uIiwiZ2V0VHJhbnNhY3Rpb25SZWZlcmVuY2UiLCJnZXRUcmFuc2FjdGlvbkRlYml0IiwiZ2V0VHJhbnNhY3Rpb25DcmVkaXQiLCJleHRyYWN0VHJhbnNhY3Rpb25EZXRhaWxzIiwidHhuUm93IiwidHhuU3RhdHVzIiwiaW5uZXJUZHMiLCJpc0V4cGFuZGVkRGVzY1JvdyIsImlkIiwiZWRpdExhc3RUcmFuc2FjdGlvbkRlc2MiLCJsYXN0VHhuIiwiaGFuZGxlVHJhbnNhY3Rpb25Sb3ciLCJ0eG5UeXBlIiwibGFzdFRyYW5zYWN0aW9uIiwicG9wIiwicHVzaCIsIkVycm9yIiwiZ2V0VHJhbnNhY3Rpb25zVGFibGVIZWFkZXJzIiwicGFnZSIsInRhYmxlVHlwZUlkIiwiaGVhZGVyc01hcCIsImhlYWRlcnNPYmpzIiwicGFnZUV2YWxBbGwiLCJ0aHMiLCJ0aCIsImluZGV4IiwidGV4dCIsImlubmVyVGV4dCIsImhlYWRlck9iaiIsImV4dHJhY3RUcmFuc2FjdGlvbnNGcm9tVGFibGUiLCJ0cmFuc2FjdGlvbnNUYWJsZUhlYWRlcnMiLCJ0cmFuc2FjdGlvbnNSb3dzIiwidHJzIiwidHIiLCJnZXRBdHRyaWJ1dGUiLCJBcnJheSIsImZyb20iLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInRkIiwiaXNOb1RyYW5zYWN0aW9uSW5EYXRlUmFuZ2VFcnJvciIsImhhc0Vycm9ySW5mb0VsZW1lbnQiLCJlbGVtZW50UHJlc2VudE9uUGFnZSIsImVycm9yVGV4dCIsIiRldmFsIiwiZXJyb3JFbGVtZW50IiwiY2hvb3NlQWNjb3VudCIsImFjY291bnRJZCIsImhhc0Ryb3BEb3duTGlzdCIsImRyb3Bkb3duU2VsZWN0Iiwic2VhcmNoQnlEYXRlcyIsInN0YXJ0RGF0ZSIsIndhaXRVbnRpbEVsZW1lbnRGb3VuZCIsImZpbGxJbnB1dCIsImZvcm1hdCIsImNsaWNrQnV0dG9uIiwid2FpdEZvck5hdmlnYXRpb24iLCJnZXRBY2NvdW50TnVtYmVyIiwic2VsZWN0ZWRTbmlmQWNjb3VudCIsIm9wdGlvbiIsImV4cGFuZFRyYW5zYWN0aW9uc1RhYmxlIiwiaGFzRXhwYW5kQWxsQnV0dG9uIiwic2NyYXBlVHJhbnNhY3Rpb25zRnJvbVRhYmxlIiwicGVuZGluZ1R4bnMiLCJUcmFuc2FjdGlvblN0YXR1c2VzIiwiUGVuZGluZyIsImNvbXBsZXRlZFR4bnMiLCJDb21wbGV0ZWQiLCJnZXRBY2NvdW50VHJhbnNhY3Rpb25zIiwiUHJvbWlzZSIsInJhY2UiLCJub1RyYW5zYWN0aW9uSW5SYW5nZUVycm9yIiwiZmV0Y2hBY2NvdW50RGF0YSIsImFjY291bnROdW1iZXIiLCJmZXRjaEFjY291bnRzIiwiYWNjb3VudHMiLCJhY2NvdW50c0xpc3QiLCJkcm9wZG93bkVsZW1lbnRzIiwiYWNjb3VudCIsImFjY291bnREYXRhIiwid2FpdEZvclBvc3RMb2dpbiIsIlVuaW9uQmFua1NjcmFwZXIiLCJCYXNlU2NyYXBlcldpdGhCcm93c2VyIiwiZ2V0TG9naW5PcHRpb25zIiwibG9naW5VcmwiLCJmaWVsZHMiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsInBvc3RBY3Rpb24iLCJwb3NzaWJsZVJlc3VsdHMiLCJmZXRjaERhdGEiLCJkZWZhdWx0U3RhcnRNb21lbnQiLCJzdWJ0cmFjdCIsImFkZCIsIm9wdGlvbnMiLCJ0b0RhdGUiLCJzdGFydE1vbWVudCIsIm1heCIsIm5hdmlnYXRlVG8iLCJzdWNjZXNzIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NjcmFwZXJzL3VuaW9uLWJhbmsudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbWVudCwgeyB0eXBlIE1vbWVudCB9IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IHR5cGUgUGFnZSB9IGZyb20gJ3B1cHBldGVlcic7XHJcbmltcG9ydCB7IFNIRUtFTF9DVVJSRU5DWSB9IGZyb20gJy4uL2NvbnN0YW50cyc7XHJcbmltcG9ydCB7XHJcbiAgY2xpY2tCdXR0b24sXHJcbiAgZHJvcGRvd25FbGVtZW50cyxcclxuICBkcm9wZG93blNlbGVjdCxcclxuICBlbGVtZW50UHJlc2VudE9uUGFnZSxcclxuICBmaWxsSW5wdXQsXHJcbiAgcGFnZUV2YWxBbGwsXHJcbiAgd2FpdFVudGlsRWxlbWVudEZvdW5kLFxyXG59IGZyb20gJy4uL2hlbHBlcnMvZWxlbWVudHMtaW50ZXJhY3Rpb25zJztcclxuaW1wb3J0IHsgd2FpdEZvck5hdmlnYXRpb24gfSBmcm9tICcuLi9oZWxwZXJzL25hdmlnYXRpb24nO1xyXG5pbXBvcnQgeyBUcmFuc2FjdGlvblN0YXR1c2VzLCBUcmFuc2FjdGlvblR5cGVzLCB0eXBlIFRyYW5zYWN0aW9uLCB0eXBlIFRyYW5zYWN0aW9uc0FjY291bnQgfSBmcm9tICcuLi90cmFuc2FjdGlvbnMnO1xyXG5pbXBvcnQgeyBCYXNlU2NyYXBlcldpdGhCcm93c2VyLCBMb2dpblJlc3VsdHMsIHR5cGUgUG9zc2libGVMb2dpblJlc3VsdHMgfSBmcm9tICcuL2Jhc2Utc2NyYXBlci13aXRoLWJyb3dzZXInO1xyXG5cclxuY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9oYi51bmlvbmJhbmsuY28uaWwnO1xyXG5jb25zdCBUUkFOU0FDVElPTlNfVVJMID0gYCR7QkFTRV9VUkx9L2VCYW5raW5nL0FjY291bnRzL0V4dGVuZGVkQWN0aXZpdHkuYXNweCMvYDtcclxuY29uc3QgREFURV9GT1JNQVQgPSAnREQvTU0vWVknO1xyXG5jb25zdCBOT19UUkFOU0FDVElPTl9JTl9EQVRFX1JBTkdFX1RFWFQgPSAn15zXkCDXp9eZ15nXnteV16og16rXoNeV16LXldeqINee16rXkNeZ157XldeqINei15wg16TXmSDXlNeh15nXoNeV158g16nXlNeV15LXk9eoJztcclxuY29uc3QgREFURV9IRUFERVIgPSAn16rXkNeo15nXmic7XHJcbmNvbnN0IERFU0NSSVBUSU9OX0hFQURFUiA9ICfXqteZ15DXldeoJztcclxuY29uc3QgUkVGRVJFTkNFX0hFQURFUiA9ICfXkNeh157Xm9eq15AnO1xyXG5jb25zdCBERUJJVF9IRUFERVIgPSAn15fXldeR15QnO1xyXG5jb25zdCBDUkVESVRfSEVBREVSID0gJ9eW15vXldeqJztcclxuY29uc3QgUEVORElOR19UUkFOU0FDVElPTlNfVEFCTEVfSUQgPSAndHJUb2RheUFjdGl2aXR5TmFwYVRhYmxlVXBwZXInO1xyXG5jb25zdCBDT01QTEVURURfVFJBTlNBQ1RJT05TX1RBQkxFX0lEID0gJ2N0bEFjdGl2aXR5VGFibGUnO1xyXG5jb25zdCBFUlJPUl9NRVNTQUdFX0NMQVNTID0gJ2VyckluZm8nO1xyXG5jb25zdCBBQ0NPVU5UU19EUk9QRE9XTl9TRUxFQ1RPUiA9ICdzZWxlY3QjZGRsQWNjb3VudHNfbV9kZGwnO1xyXG5cclxuZnVuY3Rpb24gZ2V0UG9zc2libGVMb2dpblJlc3VsdHMoKSB7XHJcbiAgY29uc3QgdXJsczogUG9zc2libGVMb2dpblJlc3VsdHMgPSB7fTtcclxuICB1cmxzW0xvZ2luUmVzdWx0cy5TdWNjZXNzXSA9IFsvZUJhbmtpbmdcXC9BY2NvdW50cy9dO1xyXG4gIHVybHNbTG9naW5SZXN1bHRzLkludmFsaWRQYXNzd29yZF0gPSBbL0ludGVybmFsU2l0ZVxcL0N1c3RvbVVwZGF0ZVxcL2xldW1pXFwvTG9naW5QYWdlLkFTUC9dO1xyXG4gIHJldHVybiB1cmxzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVMb2dpbkZpZWxkcyhjcmVkZW50aWFsczogU2NyYXBlclNwZWNpZmljQ3JlZGVudGlhbHMpIHtcclxuICByZXR1cm4gW1xyXG4gICAgeyBzZWxlY3RvcjogJyN1aWQnLCB2YWx1ZTogY3JlZGVudGlhbHMudXNlcm5hbWUgfSxcclxuICAgIHsgc2VsZWN0b3I6ICcjcGFzc3dvcmQnLCB2YWx1ZTogY3JlZGVudGlhbHMucGFzc3dvcmQgfSxcclxuICBdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRBbW91bnREYXRhKGFtb3VudFN0cjogc3RyaW5nKSB7XHJcbiAgY29uc3QgYW1vdW50U3RyQ29weSA9IGFtb3VudFN0ci5yZXBsYWNlKCcsJywgJycpO1xyXG4gIHJldHVybiBwYXJzZUZsb2F0KGFtb3VudFN0ckNvcHkpO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU2NyYXBlZFRyYW5zYWN0aW9uIHtcclxuICBjcmVkaXQ6IHN0cmluZztcclxuICBkZWJpdDogc3RyaW5nO1xyXG4gIGRhdGU6IHN0cmluZztcclxuICByZWZlcmVuY2U/OiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICBtZW1vOiBzdHJpbmc7XHJcbiAgc3RhdHVzOiBUcmFuc2FjdGlvblN0YXR1c2VzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUeG5BbW91bnQodHhuOiBTY3JhcGVkVHJhbnNhY3Rpb24pIHtcclxuICBjb25zdCBjcmVkaXQgPSBnZXRBbW91bnREYXRhKHR4bi5jcmVkaXQpO1xyXG4gIGNvbnN0IGRlYml0ID0gZ2V0QW1vdW50RGF0YSh0eG4uZGViaXQpO1xyXG4gIHJldHVybiAoTnVtYmVyLmlzTmFOKGNyZWRpdCkgPyAwIDogY3JlZGl0KSAtIChOdW1iZXIuaXNOYU4oZGViaXQpID8gMCA6IGRlYml0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY29udmVydFRyYW5zYWN0aW9ucyh0eG5zOiBTY3JhcGVkVHJhbnNhY3Rpb25bXSk6IFRyYW5zYWN0aW9uW10ge1xyXG4gIHJldHVybiB0eG5zLm1hcCh0eG4gPT4ge1xyXG4gICAgY29uc3QgY29udmVydGVkRGF0ZSA9IG1vbWVudCh0eG4uZGF0ZSwgREFURV9GT1JNQVQpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICBjb25zdCBjb252ZXJ0ZWRBbW91bnQgPSBnZXRUeG5BbW91bnQodHhuKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHR5cGU6IFRyYW5zYWN0aW9uVHlwZXMuTm9ybWFsLFxyXG4gICAgICBpZGVudGlmaWVyOiB0eG4ucmVmZXJlbmNlID8gcGFyc2VJbnQodHhuLnJlZmVyZW5jZSwgMTApIDogdW5kZWZpbmVkLFxyXG4gICAgICBkYXRlOiBjb252ZXJ0ZWREYXRlLFxyXG4gICAgICBwcm9jZXNzZWREYXRlOiBjb252ZXJ0ZWREYXRlLFxyXG4gICAgICBvcmlnaW5hbEFtb3VudDogY29udmVydGVkQW1vdW50LFxyXG4gICAgICBvcmlnaW5hbEN1cnJlbmN5OiBTSEVLRUxfQ1VSUkVOQ1ksXHJcbiAgICAgIGNoYXJnZWRBbW91bnQ6IGNvbnZlcnRlZEFtb3VudCxcclxuICAgICAgc3RhdHVzOiB0eG4uc3RhdHVzLFxyXG4gICAgICBkZXNjcmlwdGlvbjogdHhuLmRlc2NyaXB0aW9uLFxyXG4gICAgICBtZW1vOiB0eG4ubWVtbyxcclxuICAgIH07XHJcbiAgfSk7XHJcbn1cclxuXHJcbnR5cGUgVHJhbnNhY3Rpb25zVHIgPSB7IGlkOiBzdHJpbmc7IGlubmVyVGRzOiBUcmFuc2FjdGlvbnNUclRkcyB9O1xyXG50eXBlIFRyYW5zYWN0aW9uVGFibGVIZWFkZXJzID0gUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcclxudHlwZSBUcmFuc2FjdGlvbnNUclRkcyA9IHN0cmluZ1tdO1xyXG5cclxuZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25EYXRlKHRkczogVHJhbnNhY3Rpb25zVHJUZHMsIHR4bnNUYWJsZUhlYWRlcnM6IFRyYW5zYWN0aW9uVGFibGVIZWFkZXJzKSB7XHJcbiAgcmV0dXJuICh0ZHNbdHhuc1RhYmxlSGVhZGVyc1tEQVRFX0hFQURFUl1dIHx8ICcnKS50cmltKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uRGVzY3JpcHRpb24odGRzOiBUcmFuc2FjdGlvbnNUclRkcywgdHhuc1RhYmxlSGVhZGVyczogVHJhbnNhY3Rpb25UYWJsZUhlYWRlcnMpIHtcclxuICByZXR1cm4gKHRkc1t0eG5zVGFibGVIZWFkZXJzW0RFU0NSSVBUSU9OX0hFQURFUl1dIHx8ICcnKS50cmltKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uUmVmZXJlbmNlKHRkczogVHJhbnNhY3Rpb25zVHJUZHMsIHR4bnNUYWJsZUhlYWRlcnM6IFRyYW5zYWN0aW9uVGFibGVIZWFkZXJzKSB7XHJcbiAgcmV0dXJuICh0ZHNbdHhuc1RhYmxlSGVhZGVyc1tSRUZFUkVOQ0VfSEVBREVSXV0gfHwgJycpLnRyaW0oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25EZWJpdCh0ZHM6IFRyYW5zYWN0aW9uc1RyVGRzLCB0eG5zVGFibGVIZWFkZXJzOiBUcmFuc2FjdGlvblRhYmxlSGVhZGVycykge1xyXG4gIHJldHVybiAodGRzW3R4bnNUYWJsZUhlYWRlcnNbREVCSVRfSEVBREVSXV0gfHwgJycpLnRyaW0oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25DcmVkaXQodGRzOiBUcmFuc2FjdGlvbnNUclRkcywgdHhuc1RhYmxlSGVhZGVyczogVHJhbnNhY3Rpb25UYWJsZUhlYWRlcnMpIHtcclxuICByZXR1cm4gKHRkc1t0eG5zVGFibGVIZWFkZXJzW0NSRURJVF9IRUFERVJdXSB8fCAnJykudHJpbSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBleHRyYWN0VHJhbnNhY3Rpb25EZXRhaWxzKFxyXG4gIHR4blJvdzogVHJhbnNhY3Rpb25zVHIsXHJcbiAgdHhuc1RhYmxlSGVhZGVyczogVHJhbnNhY3Rpb25UYWJsZUhlYWRlcnMsXHJcbiAgdHhuU3RhdHVzOiBUcmFuc2FjdGlvblN0YXR1c2VzLFxyXG4pOiBTY3JhcGVkVHJhbnNhY3Rpb24ge1xyXG4gIGNvbnN0IHRkcyA9IHR4blJvdy5pbm5lclRkcztcclxuICByZXR1cm4ge1xyXG4gICAgc3RhdHVzOiB0eG5TdGF0dXMsXHJcbiAgICBkYXRlOiBnZXRUcmFuc2FjdGlvbkRhdGUodGRzLCB0eG5zVGFibGVIZWFkZXJzKSxcclxuICAgIGRlc2NyaXB0aW9uOiBnZXRUcmFuc2FjdGlvbkRlc2NyaXB0aW9uKHRkcywgdHhuc1RhYmxlSGVhZGVycyksXHJcbiAgICByZWZlcmVuY2U6IGdldFRyYW5zYWN0aW9uUmVmZXJlbmNlKHRkcywgdHhuc1RhYmxlSGVhZGVycyksXHJcbiAgICBkZWJpdDogZ2V0VHJhbnNhY3Rpb25EZWJpdCh0ZHMsIHR4bnNUYWJsZUhlYWRlcnMpLFxyXG4gICAgY3JlZGl0OiBnZXRUcmFuc2FjdGlvbkNyZWRpdCh0ZHMsIHR4bnNUYWJsZUhlYWRlcnMpLFxyXG4gICAgbWVtbzogJycsXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNFeHBhbmRlZERlc2NSb3codHhuUm93OiBUcmFuc2FjdGlvbnNUcikge1xyXG4gIHJldHVybiB0eG5Sb3cuaWQgPT09ICdyb3dBZGRlZCc7XHJcbn1cclxuXHJcbi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXHJcbmZ1bmN0aW9uIGVkaXRMYXN0VHJhbnNhY3Rpb25EZXNjKHR4blJvdzogVHJhbnNhY3Rpb25zVHIsIGxhc3RUeG46IFNjcmFwZWRUcmFuc2FjdGlvbik6IFNjcmFwZWRUcmFuc2FjdGlvbiB7XHJcbiAgbGFzdFR4bi5kZXNjcmlwdGlvbiA9IGAke2xhc3RUeG4uZGVzY3JpcHRpb259ICR7dHhuUm93LmlubmVyVGRzWzBdfWA7XHJcbiAgcmV0dXJuIGxhc3RUeG47XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVRyYW5zYWN0aW9uUm93KFxyXG4gIHR4bnM6IFNjcmFwZWRUcmFuc2FjdGlvbltdLFxyXG4gIHR4bnNUYWJsZUhlYWRlcnM6IFRyYW5zYWN0aW9uVGFibGVIZWFkZXJzLFxyXG4gIHR4blJvdzogVHJhbnNhY3Rpb25zVHIsXHJcbiAgdHhuVHlwZTogVHJhbnNhY3Rpb25TdGF0dXNlcyxcclxuKSB7XHJcbiAgaWYgKGlzRXhwYW5kZWREZXNjUm93KHR4blJvdykpIHtcclxuICAgIGNvbnN0IGxhc3RUcmFuc2FjdGlvbiA9IHR4bnMucG9wKCk7XHJcbiAgICBpZiAobGFzdFRyYW5zYWN0aW9uKSB7XHJcbiAgICAgIHR4bnMucHVzaChlZGl0TGFzdFRyYW5zYWN0aW9uRGVzYyh0eG5Sb3csIGxhc3RUcmFuc2FjdGlvbikpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnRlcm5hbCB1bmlvbi1iYW5rIGVycm9yJyk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHR4bnMucHVzaChleHRyYWN0VHJhbnNhY3Rpb25EZXRhaWxzKHR4blJvdywgdHhuc1RhYmxlSGVhZGVycywgdHhuVHlwZSkpO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25zVGFibGVIZWFkZXJzKHBhZ2U6IFBhZ2UsIHRhYmxlVHlwZUlkOiBzdHJpbmcpIHtcclxuICBjb25zdCBoZWFkZXJzTWFwOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0gW107XHJcbiAgY29uc3QgaGVhZGVyc09ianMgPSBhd2FpdCBwYWdlRXZhbEFsbChwYWdlLCBgI1dvcmtTcGFjZUJveCAjJHt0YWJsZVR5cGVJZH0gdHJbY2xhc3M9J2hlYWRlciddIHRoYCwgbnVsbCwgdGhzID0+IHtcclxuICAgIHJldHVybiB0aHMubWFwKCh0aCwgaW5kZXgpID0+ICh7XHJcbiAgICAgIHRleHQ6ICh0aCBhcyBIVE1MRWxlbWVudCkuaW5uZXJUZXh0LnRyaW0oKSxcclxuICAgICAgaW5kZXgsXHJcbiAgICB9KSk7XHJcbiAgfSk7XHJcblxyXG4gIGZvciAoY29uc3QgaGVhZGVyT2JqIG9mIGhlYWRlcnNPYmpzKSB7XHJcbiAgICBoZWFkZXJzTWFwW2hlYWRlck9iai50ZXh0XSA9IGhlYWRlck9iai5pbmRleDtcclxuICB9XHJcbiAgcmV0dXJuIGhlYWRlcnNNYXA7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RUcmFuc2FjdGlvbnNGcm9tVGFibGUoXHJcbiAgcGFnZTogUGFnZSxcclxuICB0YWJsZVR5cGVJZDogc3RyaW5nLFxyXG4gIHR4blR5cGU6IFRyYW5zYWN0aW9uU3RhdHVzZXMsXHJcbik6IFByb21pc2U8U2NyYXBlZFRyYW5zYWN0aW9uW10+IHtcclxuICBjb25zdCB0eG5zOiBTY3JhcGVkVHJhbnNhY3Rpb25bXSA9IFtdO1xyXG4gIGNvbnN0IHRyYW5zYWN0aW9uc1RhYmxlSGVhZGVycyA9IGF3YWl0IGdldFRyYW5zYWN0aW9uc1RhYmxlSGVhZGVycyhwYWdlLCB0YWJsZVR5cGVJZCk7XHJcblxyXG4gIGNvbnN0IHRyYW5zYWN0aW9uc1Jvd3MgPSBhd2FpdCBwYWdlRXZhbEFsbDxUcmFuc2FjdGlvbnNUcltdPihcclxuICAgIHBhZ2UsXHJcbiAgICBgI1dvcmtTcGFjZUJveCAjJHt0YWJsZVR5cGVJZH0gdHJbY2xhc3NdOm5vdChbY2xhc3M9J2hlYWRlciddKWAsXHJcbiAgICBbXSxcclxuICAgIHRycyA9PiB7XHJcbiAgICAgIHJldHVybiAodHJzIGFzIEhUTUxFbGVtZW50W10pLm1hcCh0ciA9PiAoe1xyXG4gICAgICAgIGlkOiB0ci5nZXRBdHRyaWJ1dGUoJ2lkJykgfHwgJycsXHJcbiAgICAgICAgaW5uZXJUZHM6IEFycmF5LmZyb20odHIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJykpLm1hcCh0ZCA9PiAodGQgYXMgSFRNTEVsZW1lbnQpLmlubmVyVGV4dCksXHJcbiAgICAgIH0pKTtcclxuICAgIH0sXHJcbiAgKTtcclxuXHJcbiAgZm9yIChjb25zdCB0eG5Sb3cgb2YgdHJhbnNhY3Rpb25zUm93cykge1xyXG4gICAgaGFuZGxlVHJhbnNhY3Rpb25Sb3codHhucywgdHJhbnNhY3Rpb25zVGFibGVIZWFkZXJzLCB0eG5Sb3csIHR4blR5cGUpO1xyXG4gIH1cclxuICByZXR1cm4gdHhucztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaXNOb1RyYW5zYWN0aW9uSW5EYXRlUmFuZ2VFcnJvcihwYWdlOiBQYWdlKSB7XHJcbiAgY29uc3QgaGFzRXJyb3JJbmZvRWxlbWVudCA9IGF3YWl0IGVsZW1lbnRQcmVzZW50T25QYWdlKHBhZ2UsIGAuJHtFUlJPUl9NRVNTQUdFX0NMQVNTfWApO1xyXG4gIGlmIChoYXNFcnJvckluZm9FbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBwYWdlLiRldmFsKGAuJHtFUlJPUl9NRVNTQUdFX0NMQVNTfWAsIGVycm9yRWxlbWVudCA9PiB7XHJcbiAgICAgIHJldHVybiAoZXJyb3JFbGVtZW50IGFzIEhUTUxFbGVtZW50KS5pbm5lclRleHQ7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBlcnJvclRleHQudHJpbSgpID09PSBOT19UUkFOU0FDVElPTl9JTl9EQVRFX1JBTkdFX1RFWFQ7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gY2hvb3NlQWNjb3VudChwYWdlOiBQYWdlLCBhY2NvdW50SWQ6IHN0cmluZykge1xyXG4gIGNvbnN0IGhhc0Ryb3BEb3duTGlzdCA9IGF3YWl0IGVsZW1lbnRQcmVzZW50T25QYWdlKHBhZ2UsIEFDQ09VTlRTX0RST1BET1dOX1NFTEVDVE9SKTtcclxuICBpZiAoaGFzRHJvcERvd25MaXN0KSB7XHJcbiAgICBhd2FpdCBkcm9wZG93blNlbGVjdChwYWdlLCBBQ0NPVU5UU19EUk9QRE9XTl9TRUxFQ1RPUiwgYWNjb3VudElkKTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaEJ5RGF0ZXMocGFnZTogUGFnZSwgc3RhcnREYXRlOiBNb21lbnQpIHtcclxuICBhd2FpdCBkcm9wZG93blNlbGVjdChwYWdlLCAnc2VsZWN0I2RkbFRyYW5zYWN0aW9uUGVyaW9kJywgJzAwNCcpO1xyXG4gIGF3YWl0IHdhaXRVbnRpbEVsZW1lbnRGb3VuZChwYWdlLCAnc2VsZWN0I2RkbFRyYW5zYWN0aW9uUGVyaW9kJyk7XHJcbiAgYXdhaXQgZmlsbElucHV0KHBhZ2UsICdpbnB1dCNkdEZyb21EYXRlX3RleHRCb3gnLCBzdGFydERhdGUuZm9ybWF0KERBVEVfRk9STUFUKSk7XHJcbiAgYXdhaXQgY2xpY2tCdXR0b24ocGFnZSwgJ2lucHV0I2J0bkRpc3BsYXlEYXRlcycpO1xyXG4gIGF3YWl0IHdhaXRGb3JOYXZpZ2F0aW9uKHBhZ2UpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRBY2NvdW50TnVtYmVyKHBhZ2U6IFBhZ2UpIHtcclxuICBjb25zdCBzZWxlY3RlZFNuaWZBY2NvdW50ID0gYXdhaXQgcGFnZS4kZXZhbCgnI2RkbEFjY291bnRzX21fZGRsIG9wdGlvbltzZWxlY3RlZD1cInNlbGVjdGVkXCJdJywgb3B0aW9uID0+IHtcclxuICAgIHJldHVybiAob3B0aW9uIGFzIEhUTUxFbGVtZW50KS5pbm5lclRleHQ7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBzZWxlY3RlZFNuaWZBY2NvdW50LnJlcGxhY2UoJy8nLCAnXycpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBleHBhbmRUcmFuc2FjdGlvbnNUYWJsZShwYWdlOiBQYWdlKSB7XHJcbiAgY29uc3QgaGFzRXhwYW5kQWxsQnV0dG9uID0gYXdhaXQgZWxlbWVudFByZXNlbnRPblBhZ2UocGFnZSwgXCJhW2lkKj0nbG5rQ3RsRXhwYW5kQWxsJ11cIik7XHJcbiAgaWYgKGhhc0V4cGFuZEFsbEJ1dHRvbikge1xyXG4gICAgYXdhaXQgY2xpY2tCdXR0b24ocGFnZSwgXCJhW2lkKj0nbG5rQ3RsRXhwYW5kQWxsJ11cIik7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzY3JhcGVUcmFuc2FjdGlvbnNGcm9tVGFibGUocGFnZTogUGFnZSk6IFByb21pc2U8VHJhbnNhY3Rpb25bXT4ge1xyXG4gIGNvbnN0IHBlbmRpbmdUeG5zID0gYXdhaXQgZXh0cmFjdFRyYW5zYWN0aW9uc0Zyb21UYWJsZShcclxuICAgIHBhZ2UsXHJcbiAgICBQRU5ESU5HX1RSQU5TQUNUSU9OU19UQUJMRV9JRCxcclxuICAgIFRyYW5zYWN0aW9uU3RhdHVzZXMuUGVuZGluZyxcclxuICApO1xyXG4gIGNvbnN0IGNvbXBsZXRlZFR4bnMgPSBhd2FpdCBleHRyYWN0VHJhbnNhY3Rpb25zRnJvbVRhYmxlKFxyXG4gICAgcGFnZSxcclxuICAgIENPTVBMRVRFRF9UUkFOU0FDVElPTlNfVEFCTEVfSUQsXHJcbiAgICBUcmFuc2FjdGlvblN0YXR1c2VzLkNvbXBsZXRlZCxcclxuICApO1xyXG4gIGNvbnN0IHR4bnMgPSBbLi4ucGVuZGluZ1R4bnMsIC4uLmNvbXBsZXRlZFR4bnNdO1xyXG4gIHJldHVybiBjb252ZXJ0VHJhbnNhY3Rpb25zKHR4bnMpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRBY2NvdW50VHJhbnNhY3Rpb25zKHBhZ2U6IFBhZ2UpOiBQcm9taXNlPFRyYW5zYWN0aW9uW10+IHtcclxuICBhd2FpdCBQcm9taXNlLnJhY2UoW1xyXG4gICAgd2FpdFVudGlsRWxlbWVudEZvdW5kKHBhZ2UsIGAjJHtDT01QTEVURURfVFJBTlNBQ1RJT05TX1RBQkxFX0lEfWAsIGZhbHNlKSxcclxuICAgIHdhaXRVbnRpbEVsZW1lbnRGb3VuZChwYWdlLCBgLiR7RVJST1JfTUVTU0FHRV9DTEFTU31gLCBmYWxzZSksXHJcbiAgXSk7XHJcblxyXG4gIGNvbnN0IG5vVHJhbnNhY3Rpb25JblJhbmdlRXJyb3IgPSBhd2FpdCBpc05vVHJhbnNhY3Rpb25JbkRhdGVSYW5nZUVycm9yKHBhZ2UpO1xyXG4gIGlmIChub1RyYW5zYWN0aW9uSW5SYW5nZUVycm9yKSB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICBhd2FpdCBleHBhbmRUcmFuc2FjdGlvbnNUYWJsZShwYWdlKTtcclxuICByZXR1cm4gc2NyYXBlVHJhbnNhY3Rpb25zRnJvbVRhYmxlKHBhZ2UpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBmZXRjaEFjY291bnREYXRhKHBhZ2U6IFBhZ2UsIHN0YXJ0RGF0ZTogTW9tZW50LCBhY2NvdW50SWQ6IHN0cmluZyk6IFByb21pc2U8VHJhbnNhY3Rpb25zQWNjb3VudD4ge1xyXG4gIGF3YWl0IGNob29zZUFjY291bnQocGFnZSwgYWNjb3VudElkKTtcclxuICBhd2FpdCBzZWFyY2hCeURhdGVzKHBhZ2UsIHN0YXJ0RGF0ZSk7XHJcbiAgY29uc3QgYWNjb3VudE51bWJlciA9IGF3YWl0IGdldEFjY291bnROdW1iZXIocGFnZSk7XHJcbiAgY29uc3QgdHhucyA9IGF3YWl0IGdldEFjY291bnRUcmFuc2FjdGlvbnMocGFnZSk7XHJcbiAgcmV0dXJuIHtcclxuICAgIGFjY291bnROdW1iZXIsXHJcbiAgICB0eG5zLFxyXG4gIH07XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGZldGNoQWNjb3VudHMocGFnZTogUGFnZSwgc3RhcnREYXRlOiBNb21lbnQpIHtcclxuICBjb25zdCBhY2NvdW50czogVHJhbnNhY3Rpb25zQWNjb3VudFtdID0gW107XHJcbiAgY29uc3QgYWNjb3VudHNMaXN0ID0gYXdhaXQgZHJvcGRvd25FbGVtZW50cyhwYWdlLCBBQ0NPVU5UU19EUk9QRE9XTl9TRUxFQ1RPUik7XHJcbiAgZm9yIChjb25zdCBhY2NvdW50IG9mIGFjY291bnRzTGlzdCkge1xyXG4gICAgaWYgKGFjY291bnQudmFsdWUgIT09ICctMScpIHtcclxuICAgICAgLy8gU2tpcCBcIkFsbCBhY2NvdW50c1wiIG9wdGlvblxyXG4gICAgICBjb25zdCBhY2NvdW50RGF0YSA9IGF3YWl0IGZldGNoQWNjb3VudERhdGEocGFnZSwgc3RhcnREYXRlLCBhY2NvdW50LnZhbHVlKTtcclxuICAgICAgYWNjb3VudHMucHVzaChhY2NvdW50RGF0YSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBhY2NvdW50cztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gd2FpdEZvclBvc3RMb2dpbihwYWdlOiBQYWdlKSB7XHJcbiAgcmV0dXJuIFByb21pc2UucmFjZShbd2FpdFVudGlsRWxlbWVudEZvdW5kKHBhZ2UsICcjc2lnbm9mZicsIHRydWUpLCB3YWl0VW50aWxFbGVtZW50Rm91bmQocGFnZSwgJyNyZXN0b3JlJywgdHJ1ZSldKTtcclxufVxyXG5cclxudHlwZSBTY3JhcGVyU3BlY2lmaWNDcmVkZW50aWFscyA9IHsgdXNlcm5hbWU6IHN0cmluZzsgcGFzc3dvcmQ6IHN0cmluZyB9O1xyXG5cclxuY2xhc3MgVW5pb25CYW5rU2NyYXBlciBleHRlbmRzIEJhc2VTY3JhcGVyV2l0aEJyb3dzZXI8U2NyYXBlclNwZWNpZmljQ3JlZGVudGlhbHM+IHtcclxuICBnZXRMb2dpbk9wdGlvbnMoY3JlZGVudGlhbHM6IFNjcmFwZXJTcGVjaWZpY0NyZWRlbnRpYWxzKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsb2dpblVybDogYCR7QkFTRV9VUkx9YCxcclxuICAgICAgZmllbGRzOiBjcmVhdGVMb2dpbkZpZWxkcyhjcmVkZW50aWFscyksXHJcbiAgICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnI2VudGVyJyxcclxuICAgICAgcG9zdEFjdGlvbjogYXN5bmMgKCkgPT4gd2FpdEZvclBvc3RMb2dpbih0aGlzLnBhZ2UpLFxyXG4gICAgICBwb3NzaWJsZVJlc3VsdHM6IGdldFBvc3NpYmxlTG9naW5SZXN1bHRzKCksXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZmV0Y2hEYXRhKCkge1xyXG4gICAgY29uc3QgZGVmYXVsdFN0YXJ0TW9tZW50ID0gbW9tZW50KCkuc3VidHJhY3QoMSwgJ3llYXJzJykuYWRkKDEsICdkYXknKTtcclxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHRoaXMub3B0aW9ucy5zdGFydERhdGUgfHwgZGVmYXVsdFN0YXJ0TW9tZW50LnRvRGF0ZSgpO1xyXG4gICAgY29uc3Qgc3RhcnRNb21lbnQgPSBtb21lbnQubWF4KGRlZmF1bHRTdGFydE1vbWVudCwgbW9tZW50KHN0YXJ0RGF0ZSkpO1xyXG5cclxuICAgIGF3YWl0IHRoaXMubmF2aWdhdGVUbyhUUkFOU0FDVElPTlNfVVJMKTtcclxuXHJcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGZldGNoQWNjb3VudHModGhpcy5wYWdlLCBzdGFydE1vbWVudCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgYWNjb3VudHMsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVW5pb25CYW5rU2NyYXBlcjtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFFQSxJQUFBQyxVQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxxQkFBQSxHQUFBRixPQUFBO0FBU0EsSUFBQUcsV0FBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksYUFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssdUJBQUEsR0FBQUwsT0FBQTtBQUE4RyxTQUFBRCx1QkFBQU8sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUU5RyxNQUFNRyxRQUFRLEdBQUcsNEJBQTRCO0FBQzdDLE1BQU1DLGdCQUFnQixHQUFHLEdBQUdELFFBQVEsNENBQTRDO0FBQ2hGLE1BQU1FLFdBQVcsR0FBRyxVQUFVO0FBQzlCLE1BQU1DLGlDQUFpQyxHQUFHLDhDQUE4QztBQUN4RixNQUFNQyxXQUFXLEdBQUcsT0FBTztBQUMzQixNQUFNQyxrQkFBa0IsR0FBRyxPQUFPO0FBQ2xDLE1BQU1DLGdCQUFnQixHQUFHLFFBQVE7QUFDakMsTUFBTUMsWUFBWSxHQUFHLE1BQU07QUFDM0IsTUFBTUMsYUFBYSxHQUFHLE1BQU07QUFDNUIsTUFBTUMsNkJBQTZCLEdBQUcsK0JBQStCO0FBQ3JFLE1BQU1DLCtCQUErQixHQUFHLGtCQUFrQjtBQUMxRCxNQUFNQyxtQkFBbUIsR0FBRyxTQUFTO0FBQ3JDLE1BQU1DLDBCQUEwQixHQUFHLDBCQUEwQjtBQUU3RCxTQUFTQyx1QkFBdUJBLENB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Z0JBLENBQUM3RCxJQUFVLEVBQUU7RUFDMUMsT0FBT2tELE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsSUFBQWxCLDJDQUFxQixFQUFDakMsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxJQUFBaUMsMkNBQXFCLEVBQUNqQyxJQUFJLEVBQUUsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDckg7QUFJQSxNQUFNOEQsZ0JBQWdCLFNBQVNDLDhDQUFzQixDQUE2QjtFQUNoRkMsZUFBZUEsQ0FBQzlILFdBQXVDLEVBQUU7SUFDdkQsT0FBTztNQUNMK0gsUUFBUSxFQUFFLEdBQUdsSixRQUFRLEVBQUU7TUFDdkJtSixNQUFNLEVBQUVqSSxpQkFBaUIsQ0FBQ0MsV0FBVyxDQUFDO01BQ3RDaUksb0JBQW9CLEVBQUUsUUFBUTtNQUM5QkMsVUFBVSxFQUFFLE1BQUFBLENBQUEsS0FBWVAsZ0JBQWdCLENBQUMsSUFBSSxDQUFDN0QsSUFBSSxDQUFDO01BQ25EcUUsZUFBZSxFQUFFekksdUJBQXVCLENBQUM7SUFDM0MsQ0FBQztFQUNIO0VBRUEsTUFBTTBJLFNBQVNBLENBQUEsRUFBRztJQUNoQixNQUFNQyxrQkFBa0IsR0FBRyxJQUFBakgsZUFBTSxFQUFDLENBQUMsQ0FBQ2tILFFBQVEsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDO0lBQ3RFLE1BQU16QyxTQUFTLEdBQUcsSUFBSSxDQUFDMEMsT0FBTyxDQUFDMUMsU0FBUyxJQUFJdUMsa0JBQWtCLENBQUNJLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZFLE1BQU1DLFdBQVcsR0FBR3RILGVBQU0sQ0FBQ3VILEdBQUcsQ0FBQ04sa0JBQWtCLEVBQUUsSUFBQWpILGVBQU0sRUFBQzBFLFNBQVMsQ0FBQyxDQUFDO0lBRXJFLE1BQU0sSUFBSSxDQUFDOEMsVUFBVSxDQUFDOUosZ0JBQWdCLENBQUM7SUFFdkMsTUFBTXdJLFFBQVEsR0FBRyxNQUFNRCxhQUFhLENBQUMsSUFBSSxDQUFDdkQsSUFBSSxFQUFFNEUsV0FBVyxDQUFDO0lBRTVELE9BQU87TUFDTEcsT0FBTyxFQUFFLElBQUk7TUFDYnZCO0lBQ0YsQ0FBQztFQUNIO0FBQ0Y7QUFBQyxJQUFBd0IsUUFBQSxHQUFBQyxPQUFBLENBQUFuSyxPQUFBLEdBRWNnSixnQkFBZ0IiLCJpZ25vcmVMaXN0IjpbXX0=